<%# content_for :title, "Editing group" %>
<!--
<h2 class="mt-5 mb-5 text-center fw-bold" style="font-family: 'Cinzel Decorative', serif;">Edit Group Information</h2>

<%#= render "form", group: @group %>-->
<!--
<br>

<div>
  <%#= link_to "Show this group", @group %> |-->
<%#= link_to "Back to groups", groups_path %>
<!--</div>

<hr>-->

<div class="container mt-5" style="max-width: 700px;">
  <h2 class="text-center mb-4 fw-bold" style="font-family: 'Cinzel Decorative', serif;">Edit Group</h2>

  <%= form_with model: @group, local: true, html: { multipart: true } do |form| %>
    <!-- Group Name -->
    <div class="mb-3">
      <%= form.label :name, "Group Name", class: "form-label fw-bold", style: "font-family: 'Cinzel Decorative', serif;" %>
      <%= form.text_field :name, class: "form-control" %>
    </div>

    <!-- Group Image -->
    <div class="mb-3">
      <%= form.label :image, "Group Image", class: "form-label fw-bold", style: "font-family: 'Cinzel Decorative', serif;" %>
      <%= form.file_field :image, class: "form-control" %>

      <div class="text-center mt-3">
        <% if @group.image.attached? %>
          <%= image_tag @group.image.variant(resize_to_limit: [200, 200]), class: "rounded-circle shadow-sm", style: "width: 150px; height: 150px; object-fit: cover;" %>
        <% else %>
          <%= image_tag "default-group.jpeg", class: "rounded-circle shadow-sm", style: "width: 150px; height: 150px; object-fit: cover;" %>
        <% end %>
      </div>
    </div>

    <!-- Current Members -->
    <div class="mb-4">
      <label class="form-label fw-bold" style="font-family: 'Cinzel Decorative', serif;">Current Members</label>
      <ul class="list-group">
        <% @group.users.each do |user| %>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <%= image_tag user.image.attached? ? user.image.variant(resize_to_limit: [30, 30]) : "default-avatar.jpeg", class: "rounded-circle me-2", style: "width: 30px; height: 30px; object-fit: cover;" %>
              <%= user.email.split('@').first.titleize %>
            </div>
            <% if user != current_user %>
              <%= button_to "Remove", membership_path(@group.memberships.find_by(user: user)), method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-sm btn-danger" %>
            <% end %>
          </li>
        <% end %>
      </ul>
    </div>

    <!-- Add New Members -->
    <div class="mb-4">
      <label class="form-label fw-bold" style="font-family: 'Cinzel Decorative', serif;">Add Members by Email (optional)</label>
      <%= text_area_tag :new_member_emails, nil, placeholder: "friend1@example.com, friend2@example.com", class: "form-control", rows: 3 %>
      <small class="form-text text-muted">Separate multiple emails with commas or new lines.</small>
    </div>

    <!-- Submit Buttons -->
    <div class="text-center mt-4">
      <%= form.submit "Update Group", class: "btn btn-primary px-4 fw-bold" %>
    </div>

    <div class="text-center mt-3">
      <%= link_to "Delete Group", group_path(@group), method: :delete, 
      data: { confirm: "Are you sure you want to delete this group?" }, 
      class: "btn btn-danger px-4" %>
    </div>

    <!--<div class="d-flex justify-content-between mt-4">-->
    <%#= form.submit "Update Group", class: "btn btn-primary px-4 fw-bold" %>
    <%#= button_to "Delete Group", group_path(@group), method: :delete, data: { confirm: "Are you sure you want to delete this group?" }, class: "btn btn-danger px-4" %>
    <!--    </div>-->
  <% end %>
</div>
